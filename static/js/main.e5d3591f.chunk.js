(this["webpackJsonpit-incubator-todolist-ts"]=this["webpackJsonpit-incubator-todolist-ts"]||[]).push([[0],{113:function(t,e,a){t.exports={error:"AddItemForm_error__2J-Oc",wrapper:"AddItemForm_wrapper__1GGgW"}},114:function(t,e,a){t.exports={appbar:"App_appbar__1EO4s"}},136:function(t,e,a){},189:function(t,e,a){"use strict";a.r(e);var n=a(0),s=a.n(n),i=a(11),o=a.n(i);a(136),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var c,r,l=a(54),d=a.n(l),u=a(25),j=a(231),b=a(3),f=s.a.memo((function(t){console.log("editableSpan");var e=Object(n.useState)(!0),a=Object(u.a)(e,2),s=a[0],i=a[1],o=Object(n.useState)(t.title),c=Object(u.a)(o,2),r=c[0],l=c[1];return s?Object(b.jsx)("span",{onDoubleClick:function(){i(!1)},children:r}):Object(b.jsx)(j.a,{id:"standard-basic",variant:"standard",value:r,onBlur:function(){i(!0),t.updateTitle(r)},autoFocus:!0,onChange:function(t){l(t.currentTarget.value)}})})),p=a(217),h=a(220),O=a(218),m=a(233),g=a(77),k=a.n(g),x=k.a.create({baseURL:"https://social-network.samuraijs.com/api/1.1/",withCredentials:!0,headers:{"API-KEY":"78ba9efb-88a6-4c7f-b505-5ad3ba5a9466"}});!function(t){t[t.New=0]="New",t[t.InProgress=1]="InProgress",t[t.Completed=2]="Completed",t[t.Draft=3]="Draft"}(c||(c={})),function(t){t[t.Low=0]="Low",t[t.Middle=1]="Middle",t[t.Hi=2]="Hi",t[t.Urgently=3]="Urgently",t[t.Later=4]="Later"}(r||(r={}));var v,T=function(t){return x.get("todo-lists/".concat(t,"/tasks")).then((function(t){return t.data}))},I=function(t,e){return x.post("todo-lists/".concat(t,"/tasks"),{title:e}).then((function(t){return t.data}))},C=function(t,e){return x.delete("todo-lists/".concat(t,"/tasks/").concat(e)).then((function(t){return t.data}))},y=function(t,e,a){var n=a.title,s=a.description,i=a.status,o=a.priority,c=a.startDate,r=a.deadline;return x.put("todo-lists/".concat(t,"/tasks/").concat(e),{title:n,description:s,status:i,priority:o,startDate:c,deadline:r}).then((function(t){return t.data}))},w=s.a.memo((function(t){var e=Object(n.useCallback)((function(){t.deleteTask(t.todolistId,t.taskId)}),[t.deleteTask,t.todolistId,t.taskId]),a=Object(n.useCallback)((function(e){var a=e.currentTarget.checked;t.changeTaskStatus(t.taskId,a?c.Completed:c.New,t.todolistId)}),[t.changeTaskStatus,t.taskId,t.todolistId]),s=Object(n.useCallback)((function(e){t.updateTaskTitle(t.todolistId,t.taskId,e)}),[t.updateTaskTitle,t.todolistId,t.taskId]);return Object(b.jsxs)("li",{className:t.status===c.Completed?d.a.completedTask:"",children:[Object(b.jsx)(p.a,{"aria-label":"delete",size:"small",onClick:e,children:Object(b.jsx)(O.a,{fontSize:"small"})}),Object(b.jsx)(m.a,{checked:t.status===c.Completed,onChange:a,color:"secondary",size:"small"}),Object(b.jsx)(f,{title:t.taskTitle,updateTitle:s})]})})),S=a(113),A=a.n(S),F=a(219),L=s.a.memo((function(t){var e=Object(n.useState)(""),a=Object(u.a)(e,2),s=a[0],i=a[1],o=Object(n.useState)(null),c=Object(u.a)(o,2),r=c[0],l=c[1],d=function(){""!==s.trim()?(t.addItem(s),i("")):l("name required")};return console.log("addItem"),Object(b.jsxs)("div",{className:A.a.wrapper,children:[Object(b.jsx)(j.a,{error:!!r,id:r?"outlined-error":"standard-basic",label:r?"Error":"write title",onChange:function(t){i(t.currentTarget.value),t.currentTarget.value.length>0&&l(null)},onKeyPress:function(t){"Enter"===t.key&&d()},value:s,size:"small"}),Object(b.jsx)(p.a,{size:"small",onClick:d,children:Object(b.jsx)(F.a,{style:{color:"LightGreen"}})})]})})),z=s.a.memo((function(t){console.log("todo");var e=Object(n.useCallback)((function(){t.changeTodolistFilter("all",t.todolistId)}),[t.changeTodolistFilter,t.todolistId]),a=Object(n.useCallback)((function(){t.changeTodolistFilter("completed",t.todolistId)}),[t.changeTodolistFilter,t.todolistId]),s=Object(n.useCallback)((function(){t.changeTodolistFilter("active",t.todolistId)}),[t.changeTodolistFilter,t.todolistId]),i=Object(n.useCallback)((function(){t.deleteTodolist(t.todolistId)}),[t.deleteTodolist,t.todolistId]),o=Object(n.useCallback)((function(e){t.addTask(t.todolistId,e)}),[t.addTask,t.todolistId]),r=Object(n.useCallback)((function(e){t.updateTodoTitle(t.todolistId,e)}),[t.updateTodoTitle,t.todolistId]),l=t.tasks;return"completed"===t.filter&&(l=t.tasks.filter((function(t){return t.status===c.Completed}))),"active"===t.filter&&(l=t.tasks.filter((function(t){return t.status===c.New}))),Object(b.jsxs)("div",{children:[Object(b.jsxs)("h3",{children:[Object(b.jsx)(f,{title:t.todolistTitle,updateTitle:r}),Object(b.jsx)(p.a,{"aria-label":"delete",size:"small",onClick:i,disabled:"loading"===t.entityStatus,children:Object(b.jsx)(O.a,{fontSize:"small"})})]}),Object(b.jsx)(L,{addItem:o}),Object(b.jsx)("ul",{children:l.map((function(e){return Object(b.jsx)(w,{deleteTask:t.deleteTask,changeTaskStatus:t.changeTaskStatus,updateTaskTitle:t.updateTaskTitle,taskId:e.id,todolistId:t.todolistId,status:e.status,taskTitle:e.title},e.id)}))}),Object(b.jsxs)("div",{children:[Object(b.jsx)(h.a,{variant:"text",size:"small",color:"primary",onClick:e,className:d.a.btn,children:"all"}),Object(b.jsx)(h.a,{variant:"text",size:"small",color:"primary",onClick:a,className:d.a.btn,children:"completed"}),Object(b.jsx)(h.a,{variant:"text",size:"small",color:"primary",onClick:s,className:d.a.btn,children:"active"})]})]})})),E=a(224),_=a(225),P=a(194),N=a(227),D=a(228),R=a(229),M=a(230),U=a(193),q=a(226),B=a(114),H=a.n(B),G=a(16),J=a(30),K=Object(J.b)({name:"app",initialState:{status:"idle",error:null,isInitialize:!1},reducers:{toggleIsInitialize:function(t,e){t.isInitialize=e.payload.value},setRequestStatus:function(t,e){t.status=e.payload.status},setErrorText:function(t,e){t.error=e.payload.error}}}),W=K.actions,Z=W.setRequestStatus,Y=W.toggleIsInitialize,$=W.setErrorText,V=K.reducer;!function(t){t[t.success=0]="success",t[t.error=1]="error",t[t.captcha=10]="captcha"}(v||(v={}));var Q=function(t,e){t($({error:e.message})),t(Z({status:"failed"}))},X=function(t,e){e.messages?t($({error:e.messages[0]})):t($({error:"Some error occurred"})),t(Z({status:"failed"}))},tt=a(89),et=a.n(tt),at=a(115),nt=k.a.create({baseURL:"https://social-network.samuraijs.com/api/1.1/",withCredentials:!0,headers:{"API-KEY":"78ba9efb-88a6-4c7f-b505-5ad3ba5a9466"}}),st=function(){return nt.get("todo-lists").then((function(t){return t.data}))},it=function(t){return nt.post("todo-lists",{title:t}).then((function(t){return t.data}))},ot=function(t){return nt.delete("todo-lists/".concat(t)).then((function(t){return t.data}))},ct=function(t,e){return nt.put("todo-lists/".concat(t),{title:e}).then((function(t){return t.data}))},rt=function(t){var e=t.email,a=t.password,n=t.rememberMe,s=t.captcha;return nt.post("auth/login",{email:e,password:a,rememberMe:n,captcha:s}).then((function(t){return t.data}))},lt=function(){return nt.delete("auth/login").then((function(t){return t.data}))},dt=function(){return nt.get("auth/me").then((function(t){return t.data}))},ut=Object(J.b)({name:"tasks",initialState:[],reducers:{removeTodolistAC:function(t,e){var a=t.findIndex((function(t){return t.id===e.payload.id}));-1!==a&&t.splice(a,1)},addTodolistAC:function(t,e){t.unshift(Object(G.a)(Object(G.a)({},e.payload.todolist),{},{filter:"all",entityStatus:"idle"}))},changeTodolistTitleAC:function(t){return t},changeTodolistFilterAC:function(t,e){var a=t.findIndex((function(t){return t.id===e.payload.id}));t[a]=Object(G.a)(Object(G.a)({},t[a]),{},{filter:e.payload.newFilter})},setTodolistsAC:function(t,e){return e.payload.todolists.map((function(t){return Object(G.a)(Object(G.a)({},t),{},{filter:"all",entityStatus:"idle"})}))},setTodolistProgressStatus:function(t,e){var a=t.findIndex((function(t){return t.id===e.payload.todolistId}));t[a]=Object(G.a)(Object(G.a)({},t[a]),{},{entityStatus:e.payload.entityStatus})}}}),jt=ut.actions,bt=jt.removeTodolistAC,ft=jt.addTodolistAC,pt=jt.changeTodolistTitleAC,ht=jt.changeTodolistFilterAC,Ot=jt.setTodolistsAC,mt=jt.setTodolistProgressStatus,gt=ut.reducer,kt=Object(J.b)({name:"tasks",initialState:{},reducers:{removeTaskAC:function(t,e){var a=t[e.payload.id].findIndex((function(t){return t.id===e.payload.taskId}));-1!==a&&t[e.payload.id].splice(a,1)},addTaskAC:function(t,e){t[e.payload.id].unshift(e.payload.task)},updateTaskAC:function(t,e){var a=t[e.payload.task.todoListId].findIndex((function(t){return t.id===e.payload.taskId}));t[e.payload.task.todoListId][a]=Object(G.a)(Object(G.a)({},t[e.payload.task.todoListId][a]),e.payload.task)},setTasksAC:function(t,e){t[e.payload.todolistId]=e.payload.tasks}},extraReducers:function(t){t.addCase(ft,(function(t,e){t[e.payload.todolist.id]=[]})),t.addCase(Ot,(function(t,e){e.payload.todolists.forEach((function(e){t[e.id]=[]}))})),t.addCase(bt,(function(t,e){delete t[e.payload.id]}))}}),xt=kt.actions,vt=xt.removeTaskAC,Tt=xt.addTaskAC,It=xt.updateTaskAC,Ct=xt.setTasksAC,yt=kt.reducer,wt=function(t){return function(e){e(Z({status:"loading"})),T(t).then((function(a){e(Ct({tasks:a.items,todolistId:t})),e(Z({status:"succeeded"}))}))}},St=function(t,e,a){return function(n,s){var i=s().tasks[t].find((function(t){return t.id===e}));if(i){var o={title:i.title,description:i.description,status:i.status,priority:i.priority,startDate:i.startDate,deadline:i.deadline},c=Object(G.a)(Object(G.a)({},o),a);n(Z({status:"loading"})),y(t,e,c).then((function(t){if(t.resultCode===v.success){var a=t.data.item;n(It({task:a,taskId:e})),n(Z({status:"succeeded"}))}else X(n,t)})).catch((function(t){return Q(n,t)}))}}},At=a(18),Ft=a(235),Lt=a(232),zt=a(221),Et=s.a.forwardRef((function(t,e){return Object(b.jsx)(Lt.a,Object(G.a)({elevation:6,ref:e,variant:"filled"},t))})),_t=Object(zt.a)((function(t){return{root:{width:"100%","& > * + *":{marginTop:t.spacing(2)}}}}));function Pt(){var t=Object(At.c)((function(t){return t.app.error})),e=_t(),a=Object(At.b)(),n=function(t,e){"clickaway"!==e&&a($({error:null}))};return Object(b.jsx)("div",{className:e.root,children:Object(b.jsx)(Ft.a,{open:!!t,autoHideDuration:6e3,onClose:n,children:Object(b.jsxs)(Et,{onClose:n,severity:"error",children:[t," \ud83d\ude2d"]})})})}var Nt=a(90),Dt=a.n(Nt),Rt=a(236),Mt=a(216),Ut=a(222),qt=a(223),Bt=a(118),Ht=Object(J.b)({name:"app",initialState:{isLoggedIn:!1,data:{id:null,login:null,email:null}},reducers:{setIsLoggedInAC:function(t,e){t.isLoggedIn=e.payload.value},setAuthUserData:function(t,e){t.data=e.payload.data}}}),Gt=Ht.actions,Jt=Gt.setIsLoggedInAC,Kt=(Gt.setAuthUserData,Ht.reducer),Wt=a(9),Zt=function(){var t=Object(At.b)(),e=Object(At.c)((function(t){return t.auth.isLoggedIn})),a=Object(Bt.a)({initialValues:{email:"",password:"",rememberMe:!1},validate:function(t){var e={};return t.email?/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i.test(t.email)||(e.email="Invalid email address"):e.email="Required",t.password||(e.password="Required"),t.password.length<3&&(e.password="Min password length is 3 symbols"),e},onSubmit:function(e){var n;a.resetForm(),rt(e),t((n=e,function(t){t(Z({status:"loading"})),rt(n).then((function(e){e.resultCode===v.success?(t(Jt({value:!0})),t(Z({status:"succeeded"}))):X(t,e)})).catch((function(e){return Q(t,e)}))}))}});return e?Object(b.jsx)(Wt.a,{to:"/"}):Object(b.jsx)(Dt.a,{container:!0,justifyContent:"center",children:Object(b.jsx)(Dt.a,{item:!0,justifyContent:"center",children:Object(b.jsx)("form",{onSubmit:a.handleSubmit,children:Object(b.jsxs)(Rt.a,{children:[Object(b.jsxs)(Mt.a,{children:[Object(b.jsxs)("p",{children:["To log in get registered",Object(b.jsx)("a",{href:"https://social-network.samuraijs.com/",target:"_blank",children:" here"})]}),Object(b.jsx)("p",{children:"or use common test account credentials:"}),Object(b.jsx)("p",{children:"Email: free@samuraijs.com"}),Object(b.jsx)("p",{children:"Password: free"})]}),Object(b.jsxs)(Ut.a,{children:[Object(b.jsx)(j.a,Object(G.a)({label:"Email",margin:"normal"},a.getFieldProps("email"))),a.touched.email&&a.errors.email&&Object(b.jsx)("div",{style:{color:"red"},children:a.errors.email}),Object(b.jsx)(j.a,Object(G.a)({type:"password",label:"Password",margin:"normal"},a.getFieldProps("password"))),a.touched.password&&a.errors.password&&Object(b.jsx)("div",{style:{color:"red"},children:a.errors.password}),Object(b.jsx)(qt.a,{label:"Remember me",checked:a.values.rememberMe,control:Object(b.jsx)(m.a,Object(G.a)({},a.getFieldProps("rememberMe")))}),Object(b.jsx)(h.a,{type:"submit",variant:"contained",color:"primary",children:"Login"})]})]})})})})};var Yt=function(){var t=Object(At.b)();Object(n.useEffect)((function(){t((function(t){t(Z({status:"loading"})),dt().then((function(e){e.resultCode===v.success?(t(Jt({value:!0})),t(Z({status:"succeeded"}))):X(t,e)})).catch((function(e){return Q(t,e)})).finally((function(){return t(Y({value:!0}))}))}))}),[]);var e=Object(At.c)((function(t){return t.app.status})),a=Object(At.c)((function(t){return t.app.isInitialize})),s=Object(At.c)((function(t){return t.auth.isLoggedIn})),i=Object(n.useCallback)((function(){t((function(t){t(Z({status:"loading"})),lt().then((function(e){e.resultCode===v.success?(t(Jt({value:!1})),t(Z({status:"succeeded"}))):X(t,e)})).catch((function(e){return Q(t,e)}))}))}),[t]);return Object(b.jsxs)("div",{children:[Object(b.jsx)(E.a,{position:"static",style:{background:"SkyBlue"},className:H.a.appbar,children:Object(b.jsxs)(_.a,{variant:"dense",children:[Object(b.jsx)(p.a,{edge:"start",color:"inherit","aria-label":"menu",children:Object(b.jsx)(q.a,{})}),Object(b.jsx)(P.a,{variant:"h6",children:"Todolist"}),s&&Object(b.jsx)(h.a,{onClick:i,color:"inherit",style:{float:"right"},children:"log out"})]})}),"loading"===e&&Object(b.jsx)(N.a,{}),a?Object(b.jsx)(R.a,{fixed:!0,children:Object(b.jsxs)(Wt.d,{children:[Object(b.jsx)(Wt.b,{path:"/",element:Object(b.jsx)($t,{})}),Object(b.jsx)(Wt.b,{path:"/login",element:Object(b.jsx)(Zt,{})}),Object(b.jsx)(Wt.b,{path:"*",element:Object(b.jsx)(Wt.a,{to:"/404"})})," //\u043a\u0440\u0430\u0441\u0438\u0432\u044b\u0439 url",Object(b.jsx)(Wt.b,{path:"/404",element:Object(b.jsx)("h1",{children:"404: Page not found"})})]})}):Object(b.jsx)("div",{style:{position:"fixed",top:"30%",textAlign:"center",width:"100%"},children:Object(b.jsx)(D.a,{})}),Object(b.jsx)(Pt,{})]})},$t=function(){var t=Object(At.c)((function(t){return t.auth.isLoggedIn})),e=Object(At.c)((function(t){return t.todolists})),a=Object(At.c)((function(t){return t.tasks})),s=Object(At.b)();Object(n.useEffect)((function(){t&&s((function(t){t(Z({status:"loading"})),st().then((function(e){return t(Ot({todolists:e})),t(Z({status:"succeeded"})),e})).then((function(e){e.forEach((function(e){return t(wt(e.id))}))}))}))}),[]);var i=Object(n.useCallback)((function(t,e){s(function(t,e){return function(a){a(Z({status:"loading"})),C(t,e).then((function(n){n.resultCode===v.success?(a(vt({taskId:e,id:t})),a(Z({status:"succeeded"}))):X(a,n)})).catch((function(t){Q(a,t)}))}}(t,e))}),[s]),o=Object(n.useCallback)((function(t,e){var a=ht({id:e,newFilter:t});s(a)}),[s]),c=Object(n.useCallback)((function(t,e){s(function(t,e){return function(a){a(Z({status:"loading"})),I(t,e).then((function(e){if(e.resultCode===v.success){var n=e.data.item;a(Tt({task:n,id:t})),a(Z({status:"succeeded"}))}else X(a,e)})).catch((function(t){return Q(a,t)}))}}(t,e))}),[s]),r=Object(n.useCallback)((function(t,e,a){s(St(a,t,{status:e}))}),[s]),l=Object(n.useCallback)((function(t){s(function(t){return function(e){e(Z({status:"loading"})),e(mt({entityStatus:"loading",todolistId:t})),ot(t).then((function(a){a.resultCode===v.success?(e(bt({id:t})),e(mt({entityStatus:"succeeded",todolistId:t})),e(Z({status:"succeeded"}))):(X(e,a),e(mt({entityStatus:"failed",todolistId:t})))})).catch((function(t){Q(e,t)}))}}(t))}),[s]),d=Object(n.useCallback)((function(t){var e;s((e=t,function(t){t(Z({status:"loading"})),it(e).then((function(e){e.resultCode===v.success?(t(ft({todolist:e.data.item})),t(Z({status:"succeeded"}))):X(t,e)})).catch((function(e){Q(t,e)}))}))}),[s]),u=Object(n.useCallback)((function(t,e,a){s(St(t,e,{title:a}))}),[s]),j=Object(n.useCallback)((function(t,e){s(function(t,e){return function(){var a=Object(at.a)(et.a.mark((function a(n){var s;return et.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,n(Z({status:"loading"})),a.next=4,ct(t,e);case 4:(s=a.sent).resultCode===v.success?(n(pt()),n(Z({status:"succeeded"}))):X(n,s),a.next=11;break;case 8:a.prev=8,a.t0=a.catch(0),Q(n,a.t0);case 11:case"end":return a.stop()}}),a,null,[[0,8]])})));return function(t){return a.apply(this,arguments)}}()}(t,e))}),[s]);return t?Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(M.a,{container:!0,style:{padding:"20px"},children:Object(b.jsx)(L,{addItem:d})}),Object(b.jsx)(M.a,{container:!0,spacing:3,children:e.map((function(t){var e=a[t.id];return Object(b.jsx)(M.a,{item:!0,children:Object(b.jsx)(U.a,{style:{padding:"10px"},children:Object(b.jsx)(z,{todolistId:t.id,entityStatus:t.entityStatus,todolistTitle:t.title,tasks:e,deleteTask:i,changeTodolistFilter:o,addTask:c,changeTaskStatus:r,filter:t.filter,deleteTodolist:l,updateTaskTitle:u,updateTodoTitle:j},t.id)})},t.id)}))})]}):Object(b.jsx)(Wt.a,{to:"/login"})},Vt=a(28),Qt=a(62),Xt=Object(Vt.b)({tasks:yt,todolists:gt,app:V,auth:Kt}),te=Object(J.a)({reducer:Xt,middleware:function(t){return t().prepend(Qt.a)}}),ee=a(69);o.a.render(Object(b.jsxs)(At.a,{store:te,children:[Object(b.jsxs)(ee.a,{children:[Object(b.jsx)(Yt,{})," "]})," "]}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)}))},54:function(t,e,a){t.exports={completedTask:"Todolist_completedTask__1tiHp"}}},[[189,1,2]]]);
//# sourceMappingURL=main.e5d3591f.chunk.js.map